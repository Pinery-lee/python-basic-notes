# åœ°å›¾ç¼©æ”¾çº§åˆ«

### 0.é—®é¢˜èƒŒæ™¯

æœ€è¿‘æƒ³æŠŠä¸‹è½½ä¸‹æ¥çš„åœ°å›¾åˆ‡ç‰‡æ‹¼æ¥ä¸ºtifå›¾ï¼Œä½†æ˜¯ä¸‹è½½ä¸‹æ¥æ˜¯æŒ‰ç…§å±‚çº§å’ŒX\Yç»„ç»‡çš„åˆ‡ç‰‡å›¾ç‰‡ï¼Œæ‰€æœ‰æˆ‘éœ€è¦äº†è§£åˆ‡ç‰‡çš„ç»„ç»‡å½¢å¼ï¼Œéœ€è¦äº†è§£è¿™äº›å±‚çº§å’ŒX/Yæ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ

### 1.ä¸ºä»€ä¹ˆåœ°å›¾ä¼šåˆ‡ç‰‡ï¼Ÿ

- å°†åœ°å›¾åˆ‡ç‰‡å°±æ˜¯ä¸ºäº†æŠŠä¸–ç•Œåœ°å›¾å˜æˆä¹é«˜ç§¯æœ¨ï¼Œæƒ³çœ‹å“ªå—å°±ä¸‹è½½å“ªå—ï¼Œè®©**äº¤äº’å¼åœ°å›¾ï¼ˆæ‹–ã€ç¼©æ”¾ï¼‰æ—¢å¿«åˆçœèµ„æº**ã€‚

### 2.ä¸ºä»€ä¹ˆåˆ‡ç‰‡æ˜¯æ­£æ–¹å½¢ï¼Ÿ

- èƒ½ä¿æŒä¸€è‡´è§„åˆ™ç½‘æ ¼ï¼Œä¾¿äºå®šä½ã€è®¡ç®—ç“¦ç‰‡ç´¢å¼•
- é€‚é… GPU æ¸²æŸ“æ›´å¿«
- æ­£æ–¹å½¢é€‚åˆé‡‘å­—å¡”ç¼©æ”¾ç»“æ„ï¼ˆ2Ã—2ï¼‰

![img](https://q5.itc.cn/images01/20241012/ce4519ce75b84ff99ecb80c9a92f543d.png)

### 3.åˆ‡ç‰‡çš„å¤§å°ï¼Ÿ

- ä¸€èˆ¬æ˜¯**256*256**ï¼ˆç»å¤§å¤šæ•°å›¾æºï¼‰
- ç†è®ºæ˜¯å¯ä»¥æ˜¯ä»»æ„çš„

### 4.ä»€ä¹ˆæ˜¯ç¼©æ”¾çº§åˆ«ï¼Ÿ

- ç¼©æ”¾çº§åˆ«æŒ‡çš„æ˜¯åœ°å›¾æ”¾å¤§çš„å±‚çº§ã€‚
- åœ¨åœ°å›¾ç“¦ç‰‡ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªç¼©æ”¾çº§åˆ«ä¼šå¯¼è‡´è¯·æ±‚ä¸åŒçš„ç­‰çº§ä¸‹çš„åˆ‡ç‰‡

### 5.ä¸åŒç­‰çº§ä¸‹çš„åˆ‡ç‰‡æ•°é‡ï¼Ÿ

- ä¸åŒçº§åˆ«çš„åˆ‡ç‰‡æ•°é‡å°±ç­‰äºæŠŠæ•´ä¸ªåœ°çƒåˆ‡ä¸º 2^n^ * 2^n^ ä¸ªåˆ‡ç‰‡

| Zoom | åœ°çƒç“¦ç‰‡æ•°    | æ¯ç“¦ç‰‡ä»£è¡¨çš„åŒºåŸŸ |
| ---- | ------------- | ---------------- |
| 0    | 1Ã—1 = 1       | æ•´ä¸ªåœ°çƒ         |
| 1    | 2Ã—2 = 4       | 1/4ä¸ªåœ°çƒ        |
| 2    | 4Ã—4 = 16      | 1/16åœ°çƒ         |
| ...  | ...           | ...              |
| 10   | 2^10^ * 2^10^ | ä¸€ä¸ªçœæˆ–åŸå¸‚     |
| ...  | ...           | ...              |
| 18   | 2^18^ * 2^18^ | ç¤¾åŒº/æˆ¿å±‹çº§åˆ«    |
| ...  | ...           | ...              |
| n    | 2^n^ * 2^n^   | ...              |

### 6.æ¤­åœ†çš„åœ°çƒæ˜¯æ€ä¹ˆå˜æˆå¹³é¢æ­£æ–¹å½¢çš„åˆ‡ç‰‡çš„ï¼Ÿ[bingåœ°å›¾åˆ‡ç‰‡ç³»ç»Ÿçš„ä»‹ç»](https://learn.microsoft.com/en-us/bingmaps/articles/bing-maps-tile-system)

- ä½¿ç”¨å¢¨å¡æ‰˜æŠ•å½±ï¼Œä¸€ç§åœ†æŸ±å½¢æŠ•å½±ï¼Œç‰¹ç‚¹æ˜¯ä¿ç•™äº†ç›¸å¯¹è¾ƒå°ç‰©ä½“çš„å½¢çŠ¶ï¼ˆæ–¹å½¢æŠ•å½±åè¿˜æ˜¯æ–¹å½¢ï¼‰ï¼Œä¸œè¥¿æ–¹å‘éƒ½æ˜¯å·¦å³ç¬”ç›´ï¼Œå—åŒ—æ–¹å‘éƒ½æ˜¯ä¸Šä¸‹ç¬”ç›´ï¼Œä½†é è¿‘æåœ°ç‰©ä½“ä¼šå˜å¤§
- æŠ•å½±æ“ä½œæ–¹å¼ï¼šå†çƒå¿ƒæ”¾ä¸€ä¸ªç¯æ³¡ï¼Œå…‰é€è¿‡åœ°çƒå°†èµ¤é“çš„å½±å­æ‰“åœ¨åœ†æŸ±ä¸Šï¼Œå°†åœ†æŸ±ç«–å‘å‰ªå¼€å±•å¹³å°±å¯ä»¥å¾—åˆ°æŠ•å½±åçš„å®½ï¼Œå–è¿™ä¸ªå®½ï¼Œæˆªå–å·²èµ¤é“ä¸ºä¸­å¿ƒçš„é«˜ï¼Œå°±å¾—åˆ°æŠ•å½±åçš„åœ°çƒå¹³é¢åœ°å›¾
- ä¸ºç®€åŒ–è®¡ç®—ï¼Œä¸€èˆ¬ä½¿ç”¨å¢¨å¡æ‰˜æŠ•å½±çš„çƒå½¢å½¢å¼ï¼Œå³å°†åœ°çƒç®€åŒ–ä¸ºçƒå½¢å†æŠ•å½±ï¼Œä¼šåœ¨Yæ–¹å‘ä¸Šé€ æˆå¤§æ¦‚0.33%çš„ç¼©æ”¾å¤±çœŸ
- ç”±äºæ˜¯åœ†æŸ±å½¢ï¼Œæ‰€ä»¥ä¸¤æå¤„å¯¹åº”çš„æ˜¯æ— ç©·è¿œå¤„ï¼Œæ‰€ä»¥æŠ•å½±åçš„åœ°çƒå®é™…ä¸Šå¹¶æ²¡æœ‰æ˜¾ç¤ºæ•´ä¸ªåœ°çƒï¼Œæ˜¾ç¤ºçš„æœ€å¤§ç»´åº¦æ˜¯å—çº¬85.05Â°~åŒ—çº¬85.05Â°

![å¦‚ä½•ç»˜åˆ¶å¢¨å¡æ‰˜æŠ•å½±åœ°å›¾? - çŸ¥ä¹](https://pic3.zhimg.com/v2-2cc7b055a8d25b25369a88309116740b_r.jpg?source=1940ef5c)

### 7.åˆ‡ç‰‡ç³»ç»Ÿä¸­x y zåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆï¼Ÿ

- xè¡¨ç¤ºä»å·¦åˆ°å³çš„åˆ—æ•°ï¼Œä»å·¦å¾€å³ï¼Œxé€æ¸å¢å¤§ï¼Œå€¼åŸŸæ˜¯ 0 ~ 2^Z^ - 1 ï¼ˆå·¦ â†’ å³ï¼‰
- yè¡¨ç¤ºä»ä¸Šåˆ°ä¸‹çš„è¡Œæ•°ï¼Œä»ä¸Šå¾€ä¸‹ï¼Œyé€æ¸å¢å¤§ï¼Œå€¼åŸŸæ˜¯ 0 ~ 2^Z^ - 1 ï¼ˆä¸Šâ†’ ä¸‹ï¼‰
- zè¡¨ç¤ºåœ°å›¾ç¼©æ”¾ç­‰çº§
- ä¸­å›½åœ¨45Â°å¯¹è§’çº¿å³ä¸Šæ–¹ï¼Œæ‰€ä»¥xæ¯”yå¤§ï¼Œæ‰€ä»¥åœ¨ä¸­å›½å¢ƒå†…ï¼Œæ•°å­—å¤§çš„æ˜¯xï¼Œå°çš„æ˜¯y

```
(0,0)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¶ X+
â”‚
â”‚
â–¼ Y+
```

### 8. QGIS é‡Œé¢åæ ‡è¡¨ç¤ºï¼š

- åœ°ç†åæ ‡ç³»ï¼šï¼ˆçº¬åº¦ï¼Œç»åº¦ï¼‰
- æŠ•å½±åæ ‡ç³»ï¼šï¼ˆxï¼Œyï¼‰

### 9. 3857 æŠ•å½±åæ ‡ç³»å’Œ 4326 åœ°ç†åæ ‡ç³»å¾—æ¢ç®—

- å…ˆå…³æ³¨ç»åº¦ï¼Œç»åº¦èŒƒå›´ä¸ºã€-180Â°ï¼Œ180Â°ã€‘
- 180Â°å¯¹åº”å¾—å°±æ˜¯åœ°çƒå¾—åŠå‘¨é•¿ï¼Œåœ°çƒèµ¤é“åŠå¾„ä¸ºï¼š6378137 m
- åŠå‘¨é•¿ä¸ºï¼šÏ€ * r = 3.14159 * 6378137 m = 20,037,508.342789243 m
- æ‰€ä»¥ 3857 æŠ•å½±åæ ‡ç³»ä¸‹ x çš„èŒƒå›´æ˜¯ ã€-20,037,508.342789243 mï¼Œ 20,037,508.342789243 mã€‘
- å†å…³æ³¨çº¬åº¦ï¼Œç”±äºæ˜¯åœ†æŸ±æŠ•å½±ï¼Œæ‰€ä»¥å—åŒ—æç‚¹ä¹Ÿå°±æ˜¯çº¬åº¦ä¸º90Â°æ—¶ï¼ŒæŠ•å½±çš„ä½ç½®åœ¨æ— ç©·è¿œå¤„ã€‚æ‰€ä»¥ä¸å¯èƒ½æ˜¾ç¤ºåˆ°90Â°çš„ï¼Œå¿…é¡»æˆªæ–­ï¼Œä½†æˆªæ–­åˆ°å¤šå°‘åº¦å‘¢ï¼Ÿ
- ç­”æ¡ˆæ˜¯æˆªæ–­æˆæ­£æ–¹å½¢ï¼Œæ¢å¥è¯è¯´ï¼ŒæŠ•å½±åçš„yçš„èŒƒå›´ä¹Ÿéœ€è¦æ˜¯ ã€-20,037,508.342789243 mï¼Œ 20,037,508.342789243 mã€‘ä¹Ÿå°±æ˜¯ã€- Ï€ * rï¼ŒÏ€ * rã€‘

### 10. 3857 æŠ•å½±åæ ‡ç³» y å’Œ 4326 åœ°ç†åæ ‡ç³»çº¬åº¦çš„æ¢ç®—å…¬å¼ï¼Ÿ

 **Web Mercator / Mercator æŠ•å½±** çš„æ ¸å¿ƒå˜æ¢å…¬å¼ï¼š
$$
 y = R \cdot \ln \left( \tan\left(\frac{\pi}{4} + \frac{\varphi}{2}\right)\right)
$$
å…¶ä¸­ï¼š

- $R$ = åœ°çƒåŠå¾„ï¼ˆçƒä½“å‡è®¾ï¼‰
   åœ¨ EPSG: 3857 ä¸­é‡‡ç”¨
  $$
  R = 6378137 \text{ m}
  $$

- $\varphi$ = çº¬åº¦ï¼ˆå•ä½ï¼šå¼§åº¦ï¼‰

- $y$ = æŠ•å½±åçš„åŒ—æ–¹å‘åæ ‡ï¼ˆå•ä½ï¼šç±³ï¼‰

ä»
$$
y_{\max}=R\pi = R\ln\big(\tan(\tfrac{\pi}{4}+\tfrac{\varphi_{\max}}{2})\big)
$$
 ä¸¤è¾¹é™¤ä»¥ (R)ï¼š
$$
\pi = \ln\big(\tan(\tfrac{\pi}{4}+\tfrac{\varphi_{\max}}{2})\big)
$$
 å–æŒ‡æ•°ï¼š
$$
\tan\big(\tfrac{\pi}{4}+\tfrac{\varphi_{\max}}{2}\big)=e^{\pi}
$$
 ä¸¤è¾¹å–åæ­£åˆ‡å¹¶è§£å‡º (\varphi_{\max})ï¼š
$$
 \tfrac{\pi}{4}+\tfrac{\varphi_{\max}}{2}=\arctan(e^{\pi})
$$
 æ‰€ä»¥
$$
 \varphi_{\max}=2\arctan(e^{\pi})-\tfrac{\pi}{2}.
$$

æŠŠå¼§åº¦ç»“æœæ¢æˆè§’åº¦ï¼š
$$
\varphi_{\max,(^\circ)} = \big(2\arctan(e^{\pi})-\tfrac{\pi}{2}\big)\times\frac{180}{\pi}.
$$

æ•°å€¼è®¡ç®—å¾—åˆ°ï¼š
$$
\varphi_{\max,(^\circ)} \approx 85.0511287798066^\circ.
$$

å› æ­¤æœ‰æ•ˆçš„çº¬åº¦èŒƒå›´çº¦ä¸º $[-85.05112878^\circ, +85.05112878^\circ]$ã€‚

pythonå…¬å¼ï¼š

```python
import math
lat_deg = 2*math.degrees(math.atan(math.exp(math.pi))) - 90.0
print(lat_deg)  # -> 85.0511287798066
```



------

### 11. è¿™ä¸ªæ ¸å¿ƒå˜æ¢å…¬å¼æ€ä¹ˆæ¨å¯¼å‡ºæ¥çš„ï¼Ÿ

Mercator æŠ•å½±çš„æ ¸å¿ƒæ€æƒ³ï¼š

> **ä¿æŒè§’åº¦ï¼ˆå½¢çŠ¶ï¼‰ä¸å˜ â†’ å±€éƒ¨ç­‰è§’ï¼ˆconformal projectionï¼‰**

æ•°å­¦ä¸Šï¼Œé€šè¿‡è§£å¾®åˆ†æ–¹ç¨‹ï¼š

$$
 \frac{dy}{d\varphi} = \sec \varphi = \frac{1}{\cos\varphi}
$$
å› ä¸º Mercator å¿…é¡»æ»¡è¶³ç»çº¬çº¿ä¿æŒç›´è§’ï¼Œä¸”çº¬åº¦å˜åŒ–è¢«æ”¾å¤§ï¼ˆæ­£å‰²å› å­ï¼‰ã€‚

è§£ç§¯åˆ†ï¼š

$$
y = R \int \sec\varphi  d\varphi
$$
è€Œï¼š

$$
\int \sec\varphi  d\varphi = \ln \left|\tan\left(\frac{\pi}{4} + \frac{\varphi}{2}\right)\right| + C
$$
å› æ­¤å¾—åˆ°ï¼š

$$
y = R \ln \left(\tan\left(\frac{\pi}{4} + \frac{\varphi}{2}\right)\right)
$$
è¿™å°±æ˜¯ Mercator æŠ•å½±çš„ç”±æ¥ã€‚

æ¥çœ‹è¿™ä¸ªå‡½æ•°ï¼š
$$
\tan\left(\frac{\pi}{4} + \frac{\varphi}{2}\right)
$$
å½“ $\varphi \to 90^\circ$ï¼š
$$
\frac{\pi}{4} + \frac{\pi}{2}/2 = \frac{\pi}{2}
\Rightarrow \tan\left(\frac{\pi}{2}\right) = \infty
\Rightarrow y \to +\infty
$$
å³ï¼š

ğŸŒ‹ æç‚¹é™„è¿‘ä¼šè¢«æ— é™æ‹‰ä¼¸ï¼Œæ— æ³•è¡¨ç¤ºï¼

å› æ­¤ Web Mercator **äººä¸ºæˆªæ–­**ï¼š
$$
|\varphi| \le 85.05112878^\circ
$$
ä¹Ÿå°±æ˜¯çœ‹åˆ°çš„åœ°å›¾åªæ˜¾ç¤ºåˆ°å¤§çº¦ Â±85Â°ã€‚

### 12. z å’Œåœ°é¢åˆ†è¾¨ç‡çš„å¯¹åº”å…³ç³»ï¼Ÿ

| çº§åˆ« | åœ°å›¾çš„å®½é«˜ (åƒç´ ) | åœ°é¢åˆ†è¾¨ç‡ (m / åƒç´ ) | æ¯”ä¾‹å°º (96 dpi ä¸‹) |
| :--- | :---------------- | :-------------------- | :----------------- |
| 1    | 512               | 78,271.5170           | 1 : 295,829,355.45 |
| 2    | 1,024             | 39,135.7585           | 1 : 147,914,677.73 |
| 3    | 2,048             | 19,567.8792           | 1 : 73,957,338.86  |
| 4    | 4,096             | 9,783.9396            | 1 : 36,978,669.43  |
| 5    | 8,192             | 4,891.9698            | 1 : 18,489,334.72  |
| 6    | 16,384            | 2,445.9849            | 1 : 9,244,667.36   |
| 7    | 32,768            | 1,222.9925            | 1 : 4,622,333.68   |
| 8    | 65,536            | 611.4962              | 1 : 2,311,166.84   |
| 9    | 131,072           | 305.7481              | 1 : 1,155,583.42   |
| 10   | 262,144           | 152.8741              | 1 : 577,791.71     |
| 11   | 524,288           | 76.4370               | 1 : 288,895.85     |
| 12   | 1,048,576         | 38.2185               | 1 : 144,447.93     |
| 13   | 2,097,152         | 19.1093               | 1 : 72,223.96      |
| 14   | 4,194,304         | 9.5546                | 1 : 36,111.98      |
| 15   | 8,388,608         | 4.7773                | 1 : 18,055.99      |
| 16   | 16,777,216        | 2.3887                | 1 : 9,028.00       |
| 17   | 33,554,432        | 1.1943                | 1 : 4,514.00       |
| 18   | 67,108,864        | **0.5972**            | 1 : 2,257.00       |
| 19   | 134,217,728       | 0.2986                | 1 : 1,128.50       |
| 20   | 268,435,456       | 0.1493                | 1 : 564.25         |
| 21   | 536,870,912       | 0.0746                | 1 : 282.12         |
| 22   | 1,073,741,824     | 0.0373                | 1 : 141.06         |
| 23   | 2,147,483,648     | 0.0187                | 1 : 70.53          |

### 13. z å’Œåœ°é¢åˆ†è¾¨ç‡çš„æ¢ç®—

åœ°é¢åˆ†è¾¨ç‡ = æ¯ä¸ªåƒç´ åœ¨åœ°é¢ä¸Šä»£è¡¨çš„çœŸå®è·ç¦»ï¼ˆç±³/åƒç´ ï¼‰

Web Mercator å­åˆåœˆé•¿åº¦ï¼ˆèµ¤é“å‘¨é•¿ï¼‰è¿‘ä¼¼é‡‡ç”¨ï¼š
$$
\text{EarthCircumference} = 2\pi R = 40075016.68557849 \text{ m}
$$
$$
 R = 6378137 \text{ m}
$$

åœ¨ zoom = 0 æ—¶ï¼Œæ•´å¹…åœ°å›¾æ˜¯ä¸€ä¸ª **256Ã—256** çš„ç“¦ç‰‡ï¼š
$$
 \text{Resolution}(z=0) = \frac{40075016.6856}{256} \approx 156543.033928 \text{ m/px}
$$
å¯¹äºä»»æ„çº§åˆ«ï¼š
$$
{\text{Resolution}(z) = \frac{40075016.6856}{256 \cdot 2^z}}
$$
å¯¹äºåå…«çº§ï¼š
$$
{\text{Resolution}(18) = \frac{40075016.6856}{256 \cdot 2^{18}} = 0.5971642834779395}
$$

- ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼š**è¿™ä¸ªåœ°é¢åˆ†è¾¨ç‡è·Ÿæ¸…æ™°åº¦æ— å…³**ï¼Œæ¸…æ™°åº¦åªè·Ÿå«æ˜Ÿå½±åƒçš„çœŸå®åˆ†è¾¨ç‡æœ‰å…³ã€‚
- æ­¤å¤–ï¼Œåœ¨ 18 çº§ä¸‹ï¼Œåœ¨é«˜çº¬åº¦åœ°åŒºï¼Œ**æŠ•å½±å¹³é¢ä¸Šçš„åƒç´ å¤§å°ï¼ˆè§†è§‰åæ ‡ç³»ä¸­ï¼‰ä»ç„¶æ˜¯ 0.597m/px** ä½† **ä¸æ˜¯åœ°çƒè¡¨é¢çœŸå®è·ç¦»**ï¼
- äº‹å®ä¸Šï¼Œçº¬åº¦è¶Šé«˜ï¼Œåœ¨ 3857 ä¸‹æµ‹é‡å‡ºçš„è·ç¦»ç›¸æ¯”çœŸå®è·ç¦»è¶Šå¤§ï¼Œç›¸å¯¹åº”åœ°ï¼Œæµ‹é‡å‡ºçš„é¢ç§¯è¶Šå¤§ã€‚

### 14. ç»çº¬åº¦å’Œåˆ‡ç‰‡è¡Œåˆ—x y çš„è½¬æ¢

```python
import math

TILE_SIZE = 256  # Leaflet é»˜è®¤ç“¦ç‰‡å¤§å°

def latlng_to_tile(lat, lng, zoom):
    """
    ç»çº¬åº¦è½¬XYZåˆ‡ç‰‡åæ ‡
    :param lat: çº¬åº¦
    :param lng: ç»åº¦
    :param zoom: ç¼©æ”¾çº§åˆ«
    :return: tile_x, tile_y
    """
    n = 2 ** zoom
    x = (lng + 180.0) / 360.0 * n
    lat_rad = math.radians(lat)
    y = (1 - math.log(math.tan(lat_rad) + 1 / math.cos(lat_rad)) / math.pi) / 2 * n
    return int(x), int(y)

def tile_to_latlng_bounds(tile_x, tile_y, zoom):
    """
    XYZåˆ‡ç‰‡åæ ‡è½¬ç“¦ç‰‡ç»çº¬åº¦è¾¹ç•Œ
    :param tile_x: åˆ—å·
    :param tile_y: è¡Œå·
    :param zoom: ç¼©æ”¾çº§åˆ«
    :return: (lat_min, lon_min, lat_max, lon_max)
    """
    n = 2 ** zoom
    lon_min = tile_x / n * 360.0 - 180.0
    lon_max = (tile_x + 1) / n * 360.0 - 180.0

    def y_to_lat(y):
        return math.degrees(math.atan(math.sinh(math.pi * (1 - 2 * y / n))))

    lat_max = y_to_lat(tile_y)
    lat_min = y_to_lat(tile_y + 1)
    return lat_min, lon_min, lat_max, lon_max

def latlng_rect_to_tiles(lat_min, lng_min, lat_max, lng_max, zoom):
    """
    ç»çº¬åº¦çŸ©å½¢èŒƒå›´ â†’ è¦†ç›–çš„æ‰€æœ‰åˆ‡ç‰‡åˆ—è¡¨
    :param lat_min: æœ€å—
    :param lng_min: æœ€è¥¿
    :param lat_max: æœ€åŒ—
    :param lng_max: æœ€ä¸œ
    :param zoom: ç¼©æ”¾çº§åˆ«
    :return: [(tile_x, tile_y), ...]
    """
    x_min, y_max = latlng_to_tile(lat_min, lng_min, zoom)
    x_max, y_min = latlng_to_tile(lat_max, lng_max, zoom)

    tiles = []
    for x in range(x_min, x_max + 1):
        for y in range(y_min, y_max + 1):
            tiles.append((x, y))
    return tiles

# ------------------- æµ‹è¯• -------------------
if __name__ == "__main__":
    lat_min, lng_min = 39.8, 116.3  # åŒ—äº¬é™„è¿‘çŸ©å½¢å·¦ä¸‹è§’
    lat_max, lng_max = 40.0, 116.5  # åŒ—äº¬é™„è¿‘çŸ©å½¢å³ä¸Šè§’
    zoom = 15

    tiles = latlng_rect_to_tiles(lat_min, lng_min, lat_max, lng_max, zoom)
    print(f"è¦†ç›–åˆ‡ç‰‡æ•°é‡: {len(tiles)}")
    print("éƒ¨åˆ†åˆ‡ç‰‡:", tiles[:10])

    # æµ‹è¯•å•ä¸ªåˆ‡ç‰‡è¾¹ç•Œ
    print(tile_to_latlng_bounds(tiles[0][0], tiles[0][1], zoom))

```

